
{% extends "layout.html" %}
{% block content %}
<div class="container">
    <h1>Welcome {{ current_user.username }}</h1>
    <h2>Done challenges by user</h2>
    <ul>
    {% for done_challenge in done_challenges %}
    <li>{{ done_challenge.done_at | datetime }} - {{ done_challenge.challenge.challengename }}: {{ done_challenge.challenge.co2offset }}</li>
    {% endfor %}
    <li><b>Total saved CO2: {{ total_saved_co2 }} </b></li>
    </ul>
    <h3>Please select a challenge for today</h3>

    {% for challenge in active_challenges %}
    <div id="{{ challenge.id }}">
        <h4>{{ challenge.challengename }}
            {% if challenge.user_challenge_association != None %}
                {% if challenge.user_challenge_association.done_at != None %}
                    {% if challenge.user_challenge_association.succeeded %}
                    <span class="badge badge-secondary">Done</span>
                    {% else %}
                    <span class="badge badge-secondary">Cancelled</span>
                    {% endif %}
                {% else %}
                <span class="badge badge-secondary">Committed</span>
                {% endif %}
            {% endif %}
        </h4>
        <i>Saving potential: {{ challenge.co2offset }}kg/co2</i>
        <p>{{ challenge.description }}</p>
        <p><a href="/challenges/{{ challenge.id }}" class="btn btn-primary btn-large">Details</a></p>
    </div>

    {% endfor %}

</div>

{% endblock %}

